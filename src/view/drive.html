<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../styles/theme-neptune-all.css">
    <link rel="stylesheet" href="../styles/common.css">
    <title>BACnet Config</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body,
        iframe {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        iframe {
            border: none;
        }
    </style>
</head>

<body>
    <!-- <h1>Hello World!</h1>
  We are using node
  <script>document.write(process.versions.node)</script>, Chrome
  <script>document.write(process.versions.chrome)</script>, and Electron
  <script>document.write(process.versions.electron)</script>. -->
</body>
<script src="../js/ext-all.js"></script>
<script>
    var child_process = require("child_process")
    var svc = require("../app/svc");
    var path = require("path")
    Ext.onReady(function () {
        var exeDir = path.dirname(process.argv0)
        var nodepath = path.join(exeDir, "drive/node.exe");
        var svcpath = path.join(exeDir, "drive/svc.js");
        Ext.create("Ext.panel.Panel", {
            renderTo: Ext.getBody(),
            width: "100%",
            height: "100%",
            layout: "hbox",
            items: [
                {
                    xtype: "button",
                    text: "install server",
                    handler: function () {
                        var exepath = process.argv0;
                        console.log(exepath)

                        var message = child_process.execFileSync(nodepath, [svcpath, 'install', process.argv0]).toString()
                        Ext.Msg.alert("message", message)
                    }
                }, {
                    xtype: "button",
                    text: "uninstall server",
                    handler: function () {
                        var message = child_process.execFileSync(nodepath, [svcpath, 'uninstall']).toString()
                        Ext.Msg.alert("message", message)
                    }
                }
            ]
        })
    })

</script>

</html>